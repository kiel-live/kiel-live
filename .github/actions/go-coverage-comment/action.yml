name: 'Go Coverage Comment'
description: 'Posts a coverage report comment on pull requests'
inputs:
  coverage-file:
    description: 'Path to the coverage.out file'
    required: true
  min-threshold:
    description: 'Minimum coverage threshold percentage'
    required: false
    default: '70.0'
  github-token:
    description: 'GitHub token for commenting on PRs'
    required: true

runs:
  using: 'composite'
  steps:
    - name: Post coverage comment
      uses: actions/github-script@v8
      env:
        COVERAGE_FILE: ${{ inputs.coverage-file }}
        MIN_THRESHOLD: ${{ inputs.min-threshold }}
      with:
        github-token: ${{ inputs.github-token }}
        script: |
          const script = require('${{ github.action_path }}/index.js');
          await script({ github, context, core, exec, glob, io, require });
